(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1025:
/*!****************************************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/index.vue?vue&type=template&id=f2f4f9d4&scoped=true& + 1 modules ***!
  \****************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"task-create-container":!0,"fill-height":"selectnode"===e.currentStep}},[a("TaskStep",{attrs:{list:e.stepList,"current-step":e.currentStep}}),e._v(" "),a(e.currentComponent,{ref:e.currentComponent,tag:"component",attrs:{"current-step":e.currentStep,cc_id:e.cc_id,common:e.common,template_id:e.template_id,"exclude-node":e.excludeNode,"preview-data":e.previewData},on:{setFunctionalStep:e.setFunctionalStep,setPeriodicStep:e.setPeriodicStep,setPreviewData:e.setPreviewData,setExcludeNode:e.setExcludeNode}})],1)},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},1053:
/*!*************************************************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskSelectNode.vue?vue&type=template&id=973f0a68&scoped=true& + 1 modules ***!
  \*************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading,opacity:1},expression:"{ isLoading: loading, opacity: 1 }"}],staticClass:"select-node-wrapper"},[a("div",{staticClass:"canvas-content"},[e.isSchemeShow?a("div",{class:["scheme-right-header",{"scheme-toggle-right-header":!e.showPanel}]},[a("div",{staticClass:"scheme-combine-shape",on:{click:e.togglePanel}},[a("i",{directives:[{name:"bktooltips",rawName:"v-bktooltips.top",value:e.i18n.schema,expression:"i18n.schema",modifiers:{top:!0}}],staticClass:"common-icon-paper"})])]):e._e(),e._v(" "),e.isSchemeShow&&e.showPanel?a("div",{staticClass:"node-select-scheme"},[a("div",{staticClass:"scheme-title"},[a("span",[e._v(" "+e._s(e.i18n.schemaList))])]),e._v(" "),a("div",{staticClass:"scheme-header"},[e.taskActionShow?a("div",{staticClass:"scheme-form"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:e.schemeNameRule,expression:"schemeNameRule"}],attrs:{placeholder:e.i18n.schemaName,name:"schemeName"},model:{value:e.schemeName,callback:function(t){e.schemeName=t},expression:"schemeName"}}),e._v(" "),a("bk-button",{attrs:{type:"success",size:"small"},on:{click:e.onAddScheme}},[e._v(e._s(e.i18n.affirm))]),e._v(" "),a("bk-button",{attrs:{size:"small"},on:{click:e.onCancelScheme}},[e._v(e._s(e.i18n.actionCancel))]),e._v(" "),e.errors.has("schemeName")?a("span",{staticClass:"common-error-tip error-msg"},[e._v(e._s(e.errors.first("schemeName")))]):e._e()],1):a("bk-button",{class:["save-scheme-btn",{"disabled-btn":e.isPreviewMode}],attrs:{type:"primary"},on:{click:e.onShowSchemeDialog}},[e._v(e._s(e.i18n.newSchema))])],1),e._v(" "),a("div",{staticClass:"scheme-content"},[a("ul",{staticClass:"schemeList"},e._l(e.taskScheme,function(t){return a("li",{key:t.id,class:{"scheme-item":!0,selected:t.id===e.selectedScheme&&e.lastSelectSchema===t.id},on:{click:function(a){return e.onSelectScheme(t.id)}}},[a("a",{staticClass:"scheme-name",attrs:{title:t.name}},[e._v(e._s(t.name))]),e._v(" "),a("i",{staticClass:"bk-icon icon-close-circle-shape",on:{click:function(a){return a.stopPropagation(),e.onDeleteScheme(t.id)}}})])}),0)]),e._v(" "),a("div",{staticClass:"scheme-preview-mode"},[a("div",{staticClass:"scheme-header-division-line scheme-header-division-line-last"}),e._v(" "),a("div",{staticClass:"preview-mode-switcher"},[a("span",[e._v("\n                        "+e._s(e.i18n.previewMode)+"\n                    ")]),e._v(" "),a("bk-switcher",{attrs:{size:"small",selected:e.isPreviewMode},on:{change:e.onChangePreviewNode}})],1)])]):e._e(),e._v(" "),e.loading||e.isPreviewMode?a("NodePreview",{ref:"nodePreview",attrs:{"preview-data-loading":e.previewDataLoading,"canvas-data":e.formatCanvasData(e.previewData),"preview-bread":e.previewBread,"is-select-node":e.isSchemeShow,"is-select-all-node":e.isSelectAllNode,"is-preview-mode":e.isPreviewMode},on:{onNodeClick:e.onNodeClick,onSelectSubflow:e.onSelectSubflow}}):a("pipelineCanvas",{ref:"pipelineCanvas",attrs:{"preview-data-loading":e.previewDataLoading,"is-menu-bar-show":!1,"is-config-bar-show":!1,"is-edit":!1,"is-select-node":e.isSchemeShow,"is-select-all-node":e.isSelectAllNode,"canvas-data":e.canvasData},on:{onSelectNode:e.onSelectNode}})],1),e._v(" "),a("div",{staticClass:"action-wrapper",attrs:{slot:"action-wrapper"},slot:"action-wrapper"},[a("bk-button",{staticClass:"next-button",on:{click:e.onGotoParamFill}},[e._v("\n            "+e._s(e.i18n.next)+"\n        ")])],1)])},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},1054:
/*!************************************************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskParamFill.vue?vue&type=template&id=2ea2dfac&scoped=true& + 1 modules ***!
  \************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.templateLoading,opacity:1},expression:"{ isLoading: templateLoading, opacity: 1 }"},{name:"show",rawName:"v-show",value:!e.templateLoading,expression:"!templateLoading"}],staticClass:"param-fill-wrapper"},[a("div",{class:["task-info",{"functor-task-info":"functor"===e.userType}]},[a("span",{staticClass:"task-info-title"},[e._v(e._s(e.i18n.taskInfo))]),e._v(" "),a("div",{staticClass:"task-info-division-line"}),e._v(" "),a("div",{staticClass:"common-form-item"},[a("label",{staticClass:"required"},[e._v(e._s(e.i18n.taskName))]),e._v(" "),a("div",{staticClass:"common-form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:e.taskNameRule,expression:"taskNameRule"}],staticClass:"step-form-content-size",attrs:{name:"taskName"},model:{value:e.taskName,callback:function(t){e.taskName=t},expression:"taskName"}}),e._v(" "),a("span",{staticClass:"common-error-tip error-msg"},[e._v(e._s(e.errors.first("taskName")))])],1)]),e._v(" "),e.isStartNowShow?a("div",{staticClass:"common-form-item"},[a("label",{staticClass:"required"},[e._v(e._s(e.i18n.startMethod))]),e._v(" "),a("div",{staticClass:"common-form-content"},[a("div",{staticClass:"bk-button-group"},[a("bk-button",{attrs:{type:e.isStartNow?"primary":"default"},on:{click:function(t){return e.onChangeStartNow(!0)}}},[e._v("\n                        "+e._s(e.i18n.startNow)+"\n                    ")]),e._v(" "),a("bk-button",{attrs:{type:e.isStartNow?"default":"primary"},on:{click:function(t){return e.onChangeStartNow(!1)}}},[e._v("\n                        "+e._s(e.i18n.periodicStart)+"\n                    ")])],1)])]):e._e(),e._v(" "),e.isTaskTypeShow?a("div",{staticClass:"common-form-item"},[a("label",{staticClass:"required"},[e._v(e._s(e.i18n.flowType))]),e._v(" "),a("div",{staticClass:"common-form-content"},[a("div",{staticClass:"bk-button-group"},[a("bk-button",{attrs:{type:e.isSelectFunctionalType?"default":"primary"},on:{click:function(t){return e.onSwitchTaskType(!1)}}},[e._v("\n                        "+e._s(e.i18n.defaultFlowType)+"\n                    ")]),e._v(" "),a("bk-button",{attrs:{type:e.isSelectFunctionalType?"primary":"default"},on:{click:function(t){return e.onSwitchTaskType(!0)}}},[e._v("\n                        "+e._s(e.i18n.functionFlowType)+"\n                    ")])],1)])]):e._e(),e._v(" "),e.isStartNow?e._e():a("div",{staticClass:"common-form-item"},[a("label",{staticClass:"required"},[e._v(e._s(e.i18n.periodicCron))]),e._v(" "),a("div",{staticClass:"common-form-content step-form-item-cron"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:e.periodicRule,expression:"periodicRule"}],staticClass:"step-form-content-size",attrs:{name:"periodicCron"},model:{value:e.periodicCron,callback:function(t){e.periodicCron=t},expression:"periodicCron"}}),e._v(" "),e.templateLoading?e._e():a("bk-tooltip",{staticClass:"periodic-img-tooltip",attrs:{placement:"left-end"}},[a("i",{staticClass:"common-icon-tooltips"}),e._v(" "),a("div",{attrs:{slot:"content"},slot:"content"},[a("img",{attrs:{src:e.periodicCronImg}})])]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("periodicCron"),expression:"errors.has('periodicCron')"}],staticClass:"common-error-tip error-msg"},[e._v(e._s(e.errors.first("periodicCron")))])],1)])]),e._v(" "),a("div",{staticClass:"param-info"},[a("div",{staticClass:"param-info-title"},[a("span",[e._v("\n                "+e._s(e.i18n.paramsInfo)+"\n            ")])]),e._v(" "),a("div",{staticClass:"param-info-division-line"}),e._v(" "),[e.taskParamEditLoading?e._e():a("TaskParamEdit",{ref:"TaskParamEdit",attrs:{constants:e.pipelineData.constants},on:{onChangeConfigLoading:e.onChangeConfigLoading}})]],2),e._v(" "),e.templateLoading?e._e():a("div",{staticClass:"action-wrapper"},[a("bk-button",{staticClass:"preview-step-button",on:{click:e.onGotoSelectNode}},[e._v("\n            "+e._s(e.i18n.previous)+"\n        ")]),e._v(" "),a("bk-button",{staticClass:"next-step-button",attrs:{type:"success",loading:e.isSubmit},on:{click:e.onCreateTask}},[e._v("\n            "+e._s(e.i18n.new)+"\n        ")])],1)])},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},493:
/*!*********************************************!*\
  !*** ./src/pages/task/TaskCreate/index.vue ***!
  \*********************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! ./index.vue?vue&type=template&id=f2f4f9d4&scoped=true& */1025),i=a(/*! ./index.vue?vue&type=script&lang=js& */744);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(/*! ./index.vue?vue&type=style&index=0&id=f2f4f9d4&lang=scss&scoped=true& */975);var r=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */1),o=Object(r.a)(i.default,n.a,n.b,!1,null,"f2f4f9d4",null);t.default=o.exports},540:
/*!*******************************************************************!*\
  !*** ./src/pages/task/TaskParamEdit.vue?vue&type=script&lang=js& ***!
  \*******************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! -!../../../node_modules/babel-loader/lib!../../../node_modules/vue-loader/lib??vue-loader-options!./TaskParamEdit.vue?vue&type=script&lang=js& */541),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=i.a},541:
/*!*****************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskParamEdit.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=m(a(/*! babel-runtime/helpers/slicedToArray */564)),i=m(a(/*! babel-runtime/regenerator */147)),s=m(a(/*! babel-runtime/core-js/get-iterator */210)),r=m(a(/*! babel-runtime/helpers/asyncToGenerator */148)),o=m(a(/*! babel-runtime/helpers/extends */93));a(/*! @/utils/i18n.js */10);var c=a(/*! vuex */46),l=m(a(/*! @/utils/atomFilter.js */563)),d=m(a(/*! @/utils/tools.js */208)),u=m(a(/*! @/components/common/RenderForm/RenderForm.vue */544)),p=m(a(/*! @/components/common/base/NoData.vue */510));function m(e){return e&&e.__esModule?e:{default:e}}t.default={name:"TaskParamEdit",components:{RenderForm:u.default,NoData:p.default},props:["constants","editable"],data:function(){return{variables:d.default.deepClone(this.constants),renderOption:{showGroup:!0,showLabel:!0,showHook:!1,showDesc:!0,formEdit:this.editable},renderConfig:[],metaConfig:{},renderData:{},isConfigLoading:!0,isNoData:!1}},computed:(0,o.default)({},(0,c.mapState)({atomFormConfig:function(e){return e.atomForm.config}})),watch:{constants:function(e){this.variables=d.default.deepClone(e),this.getFormData()},editable:function(e){this.$set(this.renderOption,"editable",e)}},created:function(){this.getFormData()},beforeDestroy:function(){this.clearAtomForm()},methods:(0,o.default)({},(0,c.mapActions)("atomForm/",["loadAtomConfig"]),(0,c.mapMutations)("atomForm/",["setAtomConfig"]),(0,c.mapMutations)("atomForm/",["clearAtomForm"]),{getFormData:function(){var t=this;return(0,r.default)(i.default.mark(function a(){var n,r,o,c,u,p,m,f,v,h,_,g,w,k,S,x,b;return i.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(r in n=[],t.renderConfig=[],t.renderData={},t.variables)"show"===(o=d.default.deepClone(t.variables[r])).show_type&&n.push(o);t.isNoData=!n.length,n=n.sort(function(e,t){return e.index-t.index}),c=!0,u=!1,p=void 0,a.prev=9,m=(0,s.default)(n);case 11:if(c=(f=m.next()).done){a.next=27;break}if(v=f.value,h=v.key,_=l.default.getVariableArgs(v),g=_.atomType,w=_.atom,k=_.tagCode,S=_.classify,t.atomFormConfig[g]){a.next=20;break}return t.isConfigLoading=!0,a.next=19,t.loadAtomConfig({atomType:g,classify:S});case 19:t.setAtomConfig({atomType:w,configData:e.atoms[w]});case 20:x=t.atomFormConfig[w],(b=d.default.deepClone(l.default.formFilter(k,x)))&&((v.is_meta||b.meta_transform)&&(b=b.meta_transform(v.meta||v),t.metaConfig[h]=d.default.deepClone(v),v.meta||(v.value=b.attrs.value)),b.tag_code=h,b.attrs.name=v.name,b.attrs.desc=v.desc,t.renderConfig.push(b)),t.renderData[h]=d.default.deepClone(v.value);case 24:c=!0,a.next=11;break;case 27:a.next=33;break;case 29:a.prev=29,a.t0=a.catch(9),u=!0,p=a.t0;case 33:a.prev=33,a.prev=34,!c&&m.return&&m.return();case 36:if(a.prev=36,!u){a.next=39;break}throw p;case 39:return a.finish(36);case 40:return a.finish(33);case 41:t.$nextTick(function(){t.isConfigLoading=!1,t.$emit("onChangeConfigLoading",!1)});case 42:case"end":return a.stop()}},a,t,[[9,29,33,41],[34,,36,40]])}))()},validate:function(){return this.$refs.renderForm.validate()},getVariableData:function(){var t=d.default.deepClone(this.constants);for(var a in t){var i=t[a];if(a in this.renderData)i.value=this.renderData[a],i.meta=this.metaConfig[a];else if(i.is_meta){var s=i.source_tag.split("."),r=(0,n.default)(s,2),o=r[0],c=r[1];this.atomFormConfig[o]||(this.loadAtomConfig({atomType:o}),this.setAtomConfig({atomType:o,configData:e.atoms[o]}));var u=this.atomFormConfig[o],p=d.default.deepClone(l.default.formFilter(c,u));p=p.meta_transform(i.meta||i),i.meta=d.default.deepClone(i),i.value=p.attrs.value}}return t}})}}).call(this,a(/*! jquery */32))},542:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskParamEdit.vue?vue&type=style&index=0&id=22a3d7c5&lang=scss&scoped=true& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){},549:
/*!**************************************************************!*\
  !*** ./src/pages/task/TaskStep.vue?vue&type=script&lang=js& ***!
  \**************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! -!../../../node_modules/babel-loader/lib!../../../node_modules/vue-loader/lib??vue-loader-options!./TaskStep.vue?vue&type=script&lang=js& */550),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=i.a},550:
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskStep.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a(/*! babel-runtime/helpers/extends */93));a(/*! @/utils/i18n.js */10);var i=a(/*! vuex */46);t.default={name:"TaskCreateStep",props:["list","currentStep","allFinished"],data:function(){return{i18n:{newTask:gettext("新建任务"),taskExecution:gettext("任务执行")}}},computed:(0,n.default)({},(0,i.mapState)({lang:function(e){return e.lang}}),{currentStepIndex:function(){return this.getCurrentStepIndex()},hiddenBorder:function(){return this.getCurrentStepIndex()===this.list.length-1&&this.list.length>2},taskTemplateTitle:function(){return void 0===this.$route.query.instance_id?this.i18n.newTask:this.i18n.taskExecution}}),methods:{getCurrentStepIndex:function(){var e=this,t=0;return this.list.some(function(a,n){if(a.step===e.currentStep)return t=n,!0}),t},calChartSize:function(e){var t={},a=(100/(this.list.length-1)).toFixed(2)+"%";return e!==this.list.length-1?t["flex-basis"]=a:(t["max-length"]=a,t["line-height"]="22px",t["flex-basis"]="auto !important",t["flex-shrink"]=0,t["flex-grow"]=0),t},calNameSize:function(e){var t={};if("en"===this.lang){var a=e.length-1;t.left=-2*a+"px"}return t}}}},551:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskStep.vue?vue&type=style&index=0&id=1a04ac58&lang=scss&scoped=true& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){},552:
/*!*****************************************************************!*\
  !*** ./src/pages/task/NodePreview.vue?vue&type=script&lang=js& ***!
  \*****************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! -!../../../node_modules/babel-loader/lib!../../../node_modules/vue-loader/lib??vue-loader-options!./NodePreview.vue?vue&type=script&lang=js& */553),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=i.a},553:
/*!***************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/NodePreview.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a(/*! @/utils/i18n.js */10);var n=function(e){return e&&e.__esModule?e:{default:e}}(a(/*! @/components/common/PipelineCanvas/index.vue */567));t.default={name:"NodePreview",components:{PipelineCanvas:n.default},props:["canvasData","previewBread","previewDataLoading","isSelectNode","isPreviewMode","isSelectAllNode"],data:function(){return{ellipsis:"...",showBreakList:[0,1,2],isOmit:!0}},watch:{previewBread:function(e){e.length>3?this.showBreakList=[0,e.length-1,e.length-2]:this.showBreakList=[0,1,2]}},methods:{onNodeClick:function(e){this.previewDataLoading||this.$emit("onNodeClick",e)},onSelectSubflow:function(e,t){this.previewDataLoading||this.previewBread.length-1!==t&&this.$emit("onSelectSubflow",e,t)},onUpdateNodeInfo:function(e,t){this.$refs.pipelineCanvas.onUpdateNodeInfo(t.id,t)}}}},554:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/NodePreview.vue?vue&type=style&index=0&id=17089648&lang=scss&scoped=true& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){},565:
/*!******************************************!*\
  !*** ./src/pages/task/TaskParamEdit.vue ***!
  \******************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! ./TaskParamEdit.vue?vue&type=template&id=22a3d7c5&scoped=true& */569),i=a(/*! ./TaskParamEdit.vue?vue&type=script&lang=js& */540);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(/*! ./TaskParamEdit.vue?vue&type=style&index=0&id=22a3d7c5&lang=scss&scoped=true& */568);var r=a(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */1),o=Object(r.a)(i.default,n.a,n.b,!1,null,"22a3d7c5",null);t.default=o.exports},566:
/*!****************************************!*\
  !*** ./src/assets/images/building.png ***!
  \****************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){e.exports=a.p+"images/building.png"},568:
/*!****************************************************************************************************!*\
  !*** ./src/pages/task/TaskParamEdit.vue?vue&type=style&index=0&id=22a3d7c5&lang=scss&scoped=true& ***!
  \****************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";var n=a(/*! -!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib??vue-loader-options!./TaskParamEdit.vue?vue&type=style&index=0&id=22a3d7c5&lang=scss&scoped=true& */542);a.n(n).a},569:
/*!*************************************************************************************************!*\
  !*** ./src/pages/task/TaskParamEdit.vue?vue&type=template&id=22a3d7c5&scoped=true& + 1 modules ***!
  \*************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"task-param-wrapper"},[e.isConfigLoading?e._e():a("RenderForm",{ref:"renderForm",attrs:{scheme:e.renderConfig,"form-option":e.renderOption},model:{value:e.renderData,callback:function(t){e.renderData=t},expression:"renderData"}}),e._v(" "),e.isNoData&&!e.isConfigLoading?a("NoData"):e._e()],1)},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},744:
/*!**********************************************************************!*\
  !*** ./src/pages/task/TaskCreate/index.vue?vue&type=script&lang=js& ***!
  \**********************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./index.vue?vue&type=script&lang=js& */745),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=i.a},745:
/*!********************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskCreate/index.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(/*! babel-runtime/helpers/extends */93));a(/*! @/utils/i18n.js */10);var i=a(/*! vuex */46),s=l(a(/*! ../TaskStep.vue */746)),r=l(a(/*! ./TaskSelectNode.vue */971)),o=l(a(/*! ./TaskParamFill.vue */973)),c=l(a(/*! @/utils/tools.js */208));function l(e){return e&&e.__esModule?e:{default:e}}var d=[{step:"selectnode",name:gettext("节点选择"),component:"TaskSelectNode"},{step:"paramfill",name:gettext("参数填写"),component:"TaskParamFill"},{step:"taskexecute",name:gettext("任务执行")}];t.default={name:"TaskCreate",components:{TaskStep:s.default,TaskSelectNode:r.default,TaskParamFill:o.default},props:["template_id","cc_id","step","common"],data:function(){return{stepList:d.slice(),hasFunctionalStep:!1,hasPeriodicTask:!1,previewData:[],excludeNode:[]}},computed:(0,n.default)({},(0,i.mapState)({locations:function(e){return e.template.location},lines:function(e){return e.template.line},userType:function(e){return e.userType}}),{currentStep:function(){return this.step||"selectnode"},currentComponent:function(){var e=this;return this.stepList.filter(function(t){return t.step===e.currentStep})[0].component}}),watch:{hasFunctionalStep:function(e){if(e)this.appendFunctionalization();else{var t=void 0;this.stepList.some(function(e,a){if("functionalization"===e.step)return t=a,!0}),t&&this.stepList.splice(t,1)}},hasPeriodicTask:function(e){e?e.periodicType?e.periodicType&&e.functionalType?(this.stepList.splice(2,0,{step:"functionalization",name:gettext("职能化认领"),component:"TaskParamFill"}),this.stepList.push({step:"taskexecute",name:gettext("任务执行")})):this.stepList.push({step:"taskexecute",name:gettext("任务执行")}):this.deletePeriodicCurrentStep():this.stepList.push({step:"taskexecute",name:gettext("任务执行")})}},mounted:function(){"functor"===this.userType&&this.setFunctionalStep(!0)},methods:{appendFunctionalization:function(){this.stepList.splice(2,0,{step:"functionalization",name:gettext("职能化认领"),component:"TaskParamFill"})},setFunctionalStep:function(e){this.hasFunctionalStep=e},setPeriodicStep:function(e){this.hasPeriodicTask=e},deletePeriodicCurrentStep:function(){for(;2!==this.stepList.length;)this.stepList.pop()},setPreviewData:function(e){this.previewData=c.default.deepClone(e)},setExcludeNode:function(e){this.excludeNode=e}}}},746:
/*!*************************************!*\
  !*** ./src/pages/task/TaskStep.vue ***!
  \*************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! ./TaskStep.vue?vue&type=template&id=1a04ac58&scoped=true& */847),i=a(/*! ./TaskStep.vue?vue&type=script&lang=js& */549);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(/*! ./TaskStep.vue?vue&type=style&index=0&id=1a04ac58&lang=scss&scoped=true& */747);var r=a(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */1),o=Object(r.a)(i.default,n.a,n.b,!1,null,"1a04ac58",null);t.default=o.exports},747:
/*!***********************************************************************************************!*\
  !*** ./src/pages/task/TaskStep.vue?vue&type=style&index=0&id=1a04ac58&lang=scss&scoped=true& ***!
  \***********************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";var n=a(/*! -!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib??vue-loader-options!./TaskStep.vue?vue&type=style&index=0&id=1a04ac58&lang=scss&scoped=true& */551);a.n(n).a},748:
/*!*******************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskSelectNode.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./TaskSelectNode.vue?vue&type=script&lang=js& */749),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=i.a},749:
/*!*****************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskCreate/TaskSelectNode.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(a(/*! babel-runtime/core-js/get-iterator */210)),i=g(a(/*! babel-runtime/helpers/typeof */150)),s=g(a(/*! babel-runtime/core-js/json/stringify */94)),r=g(a(/*! babel-runtime/regenerator */147)),o=g(a(/*! babel-runtime/helpers/asyncToGenerator */148)),c=g(a(/*! babel-runtime/core-js/object/assign */33)),l=g(a(/*! babel-runtime/helpers/extends */93));a(/*! @/utils/i18n.js */10);var d=a(/*! vuex */46),u=a(/*! @/utils/errorHandler.js */149),p=g(a(/*! @/utils/tools.js */208)),m=a(/*! @/constants/index.js */209),f=g(a(/*! @/components/common/PipelineCanvas/index.vue */567)),v=g(a(/*! @/components/common/base/BaseInput.vue */521)),h=g(a(/*! @/pages/task/NodePreview.vue */750)),_=g(a(/*! @/utils/formatPosition.js */851));function g(e){return e&&e.__esModule?e:{default:e}}t.default={name:"TaskSelectNode",components:{PipelineCanvas:f.default,BaseInput:v.default,NodePreview:h.default},props:["cc_id","template_id","common","excludeNode"],data:function(){return{i18n:{schemaList:gettext("执行方案列表"),newSchema:gettext("新建"),all:gettext("全选"),affirm:gettext("保存"),cancel:gettext("取消全选"),actionCancel:gettext("取消"),next:gettext("下一步"),save:gettext("执行方案保存"),schemaName:gettext("方案名称"),previewMode:gettext("预览模式："),schema:gettext("执行方案")},loading:!0,bkMessageInstance:null,isSubmit:!1,isDelete:!1,showPanel:!0,selectedNodes:[],selectedScheme:"",schemeName:"",schemeNameRule:{required:!0,max:m.STRING_LENGTH.SCHEME_NAME_MAX_LENGTH,regex:m.NAME_REG},isPreviewMode:!1,previewDataLoading:!1,version:"",previewBread:[],previewData:{location:[],line:[],gateways:{},constants:[]},taskName:"",pipelineData:"",isPreview:!1,lastSelectSchema:"",allSelectedNode:[],isSelectAllNode:!0,taskActionShow:!1}},computed:(0,l.default)({},(0,d.mapState)({activities:function(e){return e.template.activities},locations:function(e){return e.template.location},lines:function(e){return e.template.line},constants:function(e){return e.template.constants},gateways:function(e){return e.template.gateways},taskScheme:function(e){return e.task.taskScheme},app_id:function(e){return e.app_id},viewMode:function(e){return e.view_mode}}),{canvasData:function(){var e,t={};for(var a in this.gateways){var n=this.gateways[a];n.conditions&&(t[n.id]=(0,c.default)({},n.conditions))}return e="appmaker"===this.viewMode?"selectDisabled":"select",{lines:this.lines,locations:this.locations.map(function(t){return(0,l.default)({},t,{mode:e,checked:!0})}),branchConditions:t}},isSchemeShow:function(){return"appmaker"!==this.viewMode&&this.locations.some(function(e){return e.optional})}}),mounted:function(){this.getTemplateData()},methods:(0,l.default)({},(0,d.mapActions)("template/",["loadTemplateData","saveTemplateData"]),(0,d.mapActions)("task/",["loadTaskScheme","createTaskScheme","deleteTaskScheme","getSchemeDetail","loadPreviewNodeData"]),(0,d.mapActions)("appmaker/",["loadAppmakerDetail"]),(0,d.mapMutations)("template/",["setTemplateData"]),(0,d.mapMutations)("task/",["setTaskScheme"]),{getTemplateData:function(){var e=this;return(0,o.default)(r.default.mark(function t(){var a,n,i,s,o;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,a={templateId:e.template_id,common:e.common},t.next=5,e.loadTemplateData(a);case 5:return n=t.sent,e.version=n.version,e.taskName=n.name,t.next=10,e.loadTaskScheme({cc_id:e.cc_id,template_id:e.template_id});case 10:if(i=t.sent,"appmaker"!==e.viewMode){t.next=17;break}return t.next=14,e.loadAppmakerDetail(e.app_id);case 14:s=t.sent,(o=Number(s.template_scheme_id))&&e.onSelectScheme(o);case 17:e.setTaskScheme(i),e.setTemplateData(n),e.modifySelectedLocation(),e.allSelectedNode=e.selectedNodes,e.updateSelectedLocation(),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(1),(0,u.errorHandler)(t.t0,e);case 27:return t.prev=27,e.loading=!1,t.finish(27);case 30:case"end":return t.stop()}},t,e,[[1,24,27,30]])}))()},togglePanel:function(){this.showPanel=!this.showPanel},onShowSchemeDialog:function(){this.isPreviewMode||(this.taskActionShow=!0)},getExcludeNode:function(){var e=(void 0===this.$refs.pipelineCanvas?this.$refs.nodePreview.$el:this.$refs.pipelineCanvas.$el).querySelectorAll('.node-checkbox input[type="checkbox"]'),t=[];return Array.prototype.forEach.call(e,function(e){e.checked||t.push(e.dataset.id)}),t},onAddScheme:function(){var e,t=this;this.isSubmit||(this.taskScheme.some(function(e){return e.name===t.schemeName})?(0,u.errorHandler)({message:gettext("方案名称已存在")},this):(this.isSubmit=!0,this.$validator.validateAll().then((e=(0,o.default)(r.default.mark(function e(a){var n,i,o,c,l;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return t.isSubmit=!1,e.abrupt("return");case 3:return n=t.getExcludeNode(),i=[],t.canvasData.locations.forEach(function(e){"tasknode"!==e.type&&"subflow"!==e.type||-1===n.indexOf(e.id)&&i.push(e.id)}),t.selectedNodes=i,t.schemeName=t.schemeName.trim(),o={cc_id:t.cc_id,template_id:t.template_id,name:t.schemeName,data:(0,s.default)(i)},e.prev=9,e.next=12,t.createTaskScheme(o);case 12:return c=e.sent,e.next=15,t.loadTaskScheme({cc_id:t.cc_id,template_id:t.template_id});case 15:l=e.sent,t.setTaskScheme(l),t.selectedScheme=c.id,t.lastSelectSchema=c.id,t.schemeName="",t.taskActionShow=!1,t.$bkMessage({message:gettext("方案添加成功"),theme:"success"}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(9),(0,u.errorHandler)(e.t0,t);case 27:return e.prev=27,t.isSubmit=!1,e.finish(27);case 30:case"end":return e.stop()}},e,t,[[9,24,27,30]])})),function(t){return e.apply(this,arguments)}))))},updateSelectedLocation:function(){var e=this,t=this.$refs.pipelineCanvas;this.canvasData.locations.forEach(function(a){if("tasknode"===a.type||"subflow"===a.type){var n=e.selectedNodes.indexOf(a.id)>-1;e.$set(a,"checked",n),t&&t.onUpdateNodeInfo(a.id,a)}})},modifySelectedLocation:function(){var e=this,t=[];this.locations.forEach(function(a){"tasknode"!==a.type&&"subflow"!==a.type||-1!==e.excludeNode.indexOf(a.id)||t.push(a.id)}),this.selectedNodes=t},onSelectScheme:function(e){var t=this;return(0,o.default)(r.default.mark(function a(){var n;return r.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t.selectedScheme=e,t.lastSelectSchema!==e){a.next=12;break}if(t.lastSelectSchema="",!t.isPreviewMode){a.next=8;break}return a.next=6,t.getPreviewNodeData(t.template_id,!0);case 6:a.next=10;break;case 8:t.modifySelectedLocation(),t.updateSelectedLocation();case 10:a.next=27;break;case 12:return t.lastSelectSchema=e,a.prev=13,a.next=16,t.getSchemeDetail(e);case 16:if(n=a.sent,t.selectedNodes=p.default.deepClone(n.data),t.updateSelectedLocation(),!t.isPreviewMode){a.next=22;break}return a.next=22,t.getPreviewNodeData(t.template_id);case 22:a.next=27;break;case 24:a.prev=24,a.t0=a.catch(13),(0,u.errorHandler)(a.t0,t);case 27:case"end":return a.stop()}},a,t,[[13,24]])}))()},onDeleteScheme:function(e){var t=this;return(0,o.default)(r.default.mark(function a(){var n;return r.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.isDelete){a.next=2;break}return a.abrupt("return");case 2:return t.isDelete=!0,a.prev=3,a.next=6,t.deleteTaskScheme(e);case 6:return a.next=8,t.loadTaskScheme({cc_id:t.cc_id,template_id:t.template_id});case 8:n=a.sent,t.setTaskScheme(n),t.$bkMessage({message:gettext("方案删除成功"),theme:"success"}),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(3),(0,u.errorHandler)(a.t0,t);case 16:return a.prev=16,t.isDelete=!1,a.finish(16);case 19:case"end":return a.stop()}},a,t,[[3,13,16,19]])}))()},onSelectAllNode:function(){var e=[];this.canvasData.locations.forEach(function(t){"tasknode"!==t.type&&"subflow"!==t.type||(t.checked=!0,e.push(t.id))}),this.selectedNodes=e,this.updateSelectedLocation()},onSelectNoneNode:function(){this.canvasData.locations.forEach(function(e){"tasknode"!==e.type&&"subflow"!==e.type||(e.checked=!1)}),this.selectedNodes=[],this.updateSelectedLocation()},onGotoParamFill:function(){var e=this;return(0,o.default)(r.default.mark(function t(){var a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loading=!0,a=e.getExcludeNode(),t.prev=2,e.isPreview){t.next=6;break}return t.next=6,e.getPreviewNodeData(e.template_id);case 6:e.$emit("setExcludeNode",a),e.updateSelectedLocation(),e.$emit("setPreviewData",e.pipelineData),e.loading=!1,"appmaker"===e.viewMode?e.common?e.$router.push({path:"/appmaker/"+e.app_id+"/newtask/"+e.cc_id+"/paramfill/",query:{template_id:e.template_id,common:e.common}}):e.$router.push({path:"/appmaker/"+e.app_id+"/newtask/"+e.cc_id+"/paramfill/",query:{template_id:e.template_id}}):e.common?e.$router.push({path:"/template/newtask/"+e.cc_id+"/paramfill/",query:{template_id:e.template_id,common:e.common}}):e.$router.push({path:"/template/newtask/"+e.cc_id+"/paramfill/",query:{template_id:e.template_id}}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),(0,u.errorHandler)(t.t0,e);case 16:case"end":return t.stop()}},t,e,[[2,13]])}))()},onChangePreviewNode:function(e){e?(this.isPreviewMode=!0,this.previewBread.push({data:this.template_id,name:this.taskName}),this.getPreviewNodeData(this.template_id)):(this.isPreviewMode=!1,this.previewBread=[])},getPreviewNodeData:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,o.default)(r.default.mark(function n(){var i,o,c,l,d,m,f,v;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.previewDataLoading=!0,t.isPreview=!0,i=void 0;try{i=t.getExcludeNode()}catch(e){i=t.getExecuteNodeList()}return i=a?[]:i,o=t.common?"common":"business",c={templateId:e,excludeTaskNodesId:(0,s.default)(i),common:t.common,cc_id:t.cc_id,template_source:o,version:t.version},n.prev=7,n.next=10,t.loadPreviewNodeData(c);case 10:(l=n.sent).result?(d=l.data.pipeline_tree,m=d.line,f=d.location,_.default.isLocationAllNode(f)&&(v=_.default.formatPosition(m,f),d.line=v.lines,d.location=v.locations),t.previewData=d,t.canvasData.locations.forEach(function(e){"tasknode"!==e.type&&"subflow"!==e.type||e.id in d.activities||(e.checked=!1)}),a||(t.pipelineData=p.default.deepClone(d))):(0,u.errorHandler)(l,t),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(7),(0,u.errorHandler)(n.t0,t);case 17:return n.prev=17,t.previewDataLoading=!1,n.finish(17);case 20:case"end":return n.stop()}},n,t,[[7,14,17,20]])}))()},clearUnnecessaryGateway:function(e){var t=e.line,a=e.location,s=[],r=!0,o=!1,l=void 0;try{for(var d,u=(0,n.default)(t);!(r=(d=u.next()).done);r=!0){var p=d.value,m=p.source.id,f=p.target.id;s[m]?s[m].push(f):s[m]=[f]}}catch(e){o=!0,l=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw l}}return a.forEach(function(e){var r=e.type,o=e.id;if("parallelgateway"===r||"branchgateway"===r){var c=[];s[o].forEach(function(e){-1===c.indexOf(e)&&c.push(e)});var l=c.length,d=a.find(function(e){return e.id===c[0]}),u=void 0;if(void 0!==d&&(u=d.type),1===l&&"subflow"!==u&&"tasknode"!==u){var p=function(){var e=s[o][0],n=a.find(function(t){return t.id===e});if(!n||"convergegateway"!==n.type)return{v:void 0};var i=t.find(function(t){return t.source.id===e}).target.id,r=t.find(function(e){return e.target.id===o}).source.id;for(t.find(function(e){return e.source.id===r&&e.target.id===o}).target.id=i;;){var c=t.findIndex(function(e){return e.source.id===o});-1!==c&&t.splice(c,1);var l=t.findIndex(function(t){return t.target.id===e});-1!==l&&t.splice(l,1);var d=t.findIndex(function(t){return t.source.id===e});if(-1!==d&&t.splice(d,1),-1===c&&-1===l&&-1===d)break}var u=a.findIndex(function(t){return t.id===e});a.splice(u,1);var p=a.findIndex(function(e){return e.id===o});a.splice(p,1)}();if("object"===(void 0===p?"undefined":(0,i.default)(p)))return p.v}else c.forEach(function(e){if(a.find(function(t){return t.id===e&&"convergegateway"===t.type})){var i=!0,r=!1,c=void 0;try{for(var l,d=(0,n.default)(s[o]);!(i=(l=d.next()).done);i=!0)if(l.value===e){var u=t.findIndex(function(t){return t.target.id===e&&t.source.id===o});t.splice(u,1)}}catch(e){r=!0,c=e}finally{try{!i&&d.return&&d.return()}finally{if(r)throw c}}}})}}),(0,c.default)(e,{line:t,location:a})},onNodeClick:function(e){var t=this.previewData.activities[e];if(t&&"SubProcess"===t.type){var a=t.template_id;this.previewBread.push({data:a,name:t.name}),this.getPreviewNodeData(a,!0)}},onSelectSubflow:function(e,t){e===this.template_id?(this.previewData=this.pipelineData,this.updateCanvas()):this.getPreviewNodeData(e,!0),this.previewBread.splice(t+1,this.previewBread.length)},formatCanvasData:function(e){var t=e.line,a=e.location,n=e.gateways,i={};for(var s in n){var r=n[s];r.conditions&&(i[r.id]=(0,c.default)({},r.conditions))}return{lines:t,locations:a.map(function(e){return(0,l.default)({},e,{mode:"preview",checked:!0})}),branchConditions:i}},updateCanvas:function(){var e=this;this.loading=!0,this.previewDataLoading=!0,this.$nextTick(function(){e.loading=!1,e.previewDataLoading=!1})},getExecuteNodeList:function(){var e=this;return this.allSelectedNode.filter(function(t){return!e.selectedNodes.includes(t)})},onSelectNode:function(e){this.isSelectAllNode=e,e?this.onSelectAllNode():this.onSelectNoneNode()},onCancelScheme:function(){this.schemeName="",this.taskActionShow=!1}})}},750:
/*!****************************************!*\
  !*** ./src/pages/task/NodePreview.vue ***!
  \****************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! ./NodePreview.vue?vue&type=template&id=17089648&scoped=true& */848),i=a(/*! ./NodePreview.vue?vue&type=script&lang=js& */552);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(/*! ./NodePreview.vue?vue&type=style&index=0&id=17089648&lang=scss&scoped=true& */751);var r=a(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */1),o=Object(r.a)(i.default,n.a,n.b,!1,null,"17089648",null);t.default=o.exports},751:
/*!**************************************************************************************************!*\
  !*** ./src/pages/task/NodePreview.vue?vue&type=style&index=0&id=17089648&lang=scss&scoped=true& ***!
  \**************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";var n=a(/*! -!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib!../../../node_modules/sass-loader/lib/loader.js!../../../node_modules/vue-loader/lib??vue-loader-options!./NodePreview.vue?vue&type=style&index=0&id=17089648&lang=scss&scoped=true& */554);a.n(n).a},752:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskCreate/TaskSelectNode.vue?vue&type=style&index=0&id=973f0a68&lang=scss&scoped=true& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){},753:
/*!******************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskParamFill.vue?vue&type=script&lang=js& ***!
  \******************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./TaskParamFill.vue?vue&type=script&lang=js& */754),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=i.a},754:
/*!****************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskCreate/TaskParamFill.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(a(/*! babel-runtime/regenerator */147)),i=v(a(/*! babel-runtime/core-js/json/stringify */94)),s=v(a(/*! babel-runtime/helpers/asyncToGenerator */148)),r=v(a(/*! babel-runtime/core-js/object/keys */95)),o=v(a(/*! babel-runtime/helpers/extends */93));a(/*! @/utils/i18n.js */10);var c=v(a(/*! moment-timezone */520)),l=a(/*! vuex */46),d=a(/*! @/utils/errorHandler.js */149),u=a(/*! @/constants/index.js */209),p=v(a(/*! @/utils/tools.js */208)),m=v(a(/*! @/components/common/base/BaseInput.vue */521)),f=v(a(/*! ../TaskParamEdit.vue */565));function v(e){return e&&e.__esModule?e:{default:e}}t.default={name:"TaskParamFill",components:{BaseInput:m.default,TaskParamEdit:f.default},props:["cc_id","template_id","common","previewData"],data:function(){return{i18n:{taskInfo:gettext("任务信息"),taskName:gettext("任务名称"),flowType:gettext("流程类型"),defaultFlowType:gettext("默认任务流程"),functionFlowType:gettext("职能化任务流程"),paramsInfo:gettext("参数信息"),previous:gettext("上一步"),new:gettext("下一步"),startNow:gettext("立即执行"),periodicStart:gettext("周期执行"),periodicCron:gettext("周期表达式"),startMethod:gettext("执行计划")},templateLoading:!0,bkMessageInstance:null,isSubmit:!1,isSelectFunctionalType:!1,taskName:"",pipelineData:{},taskNameRule:{required:!0,max:u.STRING_LENGTH.TASK_NAME_MAX_LENGTH,regex:u.NAME_REG},isStartNow:!0,periodicCron:"*/5 * * * *",periodicRule:{required:!0,regex:u.PERIODIC_REG},periodicCronImg:a(755)("./"+gettext("task-zh")+".png"),lastTaskName:"",node:{},templateData:{},configLoading:!0,taskParamEditLoading:!0}},computed:(0,o.default)({},(0,l.mapState)({templateName:function(e){return e.template.name},userType:function(e){return e.userType},viewMode:function(e){return e.view_mode},app_id:function(e){return e.app_id},businessTimezone:function(e){return e.businessTimezone}}),{isSchemeShow:function(){return this.pipelineData.location.some(function(e){return e.optional})},isTaskTypeShow:function(){return"functor"!==this.userType&&this.isStartNow},isVariableEmpty:function(){return!this.pipelineData.constants||0===(0,r.default)(this.pipelineData.constants).length},isStartNowShow:function(){return!this.common&&"app"===this.viewMode&&"functor"!==this.userType}}),watch:{configLoading:function(e){e||(this.templateLoading=!1)}},mounted:function(){this.loadData()},methods:(0,o.default)({},(0,l.mapActions)("template/",["loadTemplateData"]),(0,l.mapActions)("task/",["loadPreviewNodeData","createTask"]),(0,l.mapMutations)("template/",["setTemplateData"]),(0,l.mapActions)("periodic/",["createPeriodic"]),{loadData:function(){var e=this;return(0,s.default)(n.default.mark(function t(){var a,s,r,o,c;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.templateLoading=!0,t.prev=1,a={templateId:e.template_id,common:e.common},s=e.common?"common":"business",t.next=6,e.loadTemplateData(a);case 6:if(r=t.sent,e.setTemplateData(r),0!==e.previewData.length){t.next=16;break}return o={templateId:e.template_id,excludeTaskNodesId:(0,i.default)([]),common:e.common,cc_id:e.cc_id,template_source:s,version:r.version},t.next=12,e.loadPreviewNodeData(o);case 12:c=t.sent,e.pipelineData=c.data.pipeline_tree,t.next=17;break;case 16:e.pipelineData=p.default.deepClone(e.previewData);case 17:e.taskName=e.getDefaultTaskName(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(1),(0,d.errorHandler)(t.t0,e);case 23:return t.prev=23,e.taskParamEditLoading=!1,t.finish(23);case 26:case"end":return t.stop()}},t,e,[[1,20,23,26]])}))()},getDefaultTaskName:function(){var e;return e=this.common?(0,c.default)().format("YYYYMMDDHHmmss"):c.default.tz(this.businessTimezone).format("YYYYMMDDHHmmss"),this.templateName+"_"+e},onSwitchTaskType:function(e){this.isSelectFunctionalType=e,this.$emit("setFunctionalStep",e)},onGotoSelectNode:function(){this.$emit("setFunctionalStep",!1),"appmaker"===this.viewMode?this.$router.push({path:"/appmaker/"+this.app_id+"/newtask/"+this.cc_id+"/selectnode/",query:{template_id:this.template_id}}):this.common?this.$router.push({path:"/template/newtask/"+this.cc_id+"/selectnode/",query:{template_id:this.template_id,common:this.common}}):this.$router.push({path:"/template/newtask/"+this.cc_id+"/selectnode/",query:{template_id:this.template_id}})},onCreateTask:function(){var e,t=this;if(!this.isSubmit){var a=this.$refs.TaskParamEdit;this.$validator.validateAll().then((e=(0,s.default)(n.default.mark(function e(s){var r,o,c,l,u,m,f,v,h;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,o=p.default.deepClone(t.pipelineData),a&&(c=a.getVariableData(),o.constants=c,r=a.validate()),s&&r){e.next=5;break}return e.abrupt("return");case 5:if(t.isSubmit=!0,void 0,l="functor"===t.userType?"common_func":t.isSelectFunctionalType?"common_func":"common",!t.isStartNow){e.next=25;break}return u={name:t.taskName,description:"",templateId:t.template_id,execData:(0,i.default)(o),flowType:l,common:t.common},e.prev=10,e.next=13,t.createTask(u);case 13:m=e.sent,"appmaker"===t.viewMode?t.isSelectFunctionalType?t.$router.push({path:"/appmaker/"+t.app_id+"/task_home/"+t.cc_id+"/"}):t.$router.push({path:"/appmaker/"+t.app_id+"/execute/"+t.cc_id+"/",query:{instance_id:m.instance_id}}):t.isSelectFunctionalType?t.common?t.$router.push({path:"/taskflow/home/"+t.cc_id+"/",query:{common:t.common}}):t.$router.push({path:"/taskflow/home/"+t.cc_id+"/"}):t.$router.push({path:"/taskflow/execute/"+t.cc_id+"/",query:{instance_id:m.instance_id}}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),(0,d.errorHandler)(e.t0,t);case 20:return e.prev=20,t.isSubmit=!1,e.finish(20);case 23:e.next=41;break;case 25:return f=t.periodicCron.split(" "),v=(0,i.default)({minute:f[0],hour:f[1],day_of_week:f[2],day_of_month:f[3],month_of_year:f[4]}),h={name:t.taskName,cron:v,templateId:t.template_id,execData:(0,i.default)(o)},e.prev=28,e.next=31,t.createPeriodic(h);case 31:t.$bkMessage({message:gettext("创建周期任务成功"),theme:"success"}),t.$router.push({path:"/periodic/home/"+t.cc_id+"/"}),e.next=38;break;case 35:e.prev=35,e.t1=e.catch(28),(0,d.errorHandler)(e.t1,t);case 38:return e.prev=38,t.isSubmit=!1,e.finish(38);case 41:case"end":return e.stop()}},e,t,[[10,17,20,23],[28,35,38,41]])})),function(t){return e.apply(this,arguments)}))}},onChangeStartNow:function(e){e!==this.isStartNow&&(this.isStartNow=e,this.$emit("setPeriodicStep",{periodicType:e,functionalType:this.isSelectFunctionalType}),e?this.taskName=this.lastTaskName:(this.lastTaskName=this.taskName,this.taskName=this.templateName))},onChangeConfigLoading:function(e){this.configLoading=e}})}},755:
/*!**********************************************!*\
  !*** ./src/assets/images sync ^\.\/.*\.png$ ***!
  \**********************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){var n={"./building.png":566,"./expre_401.png":212,"./expre_403.png":213,"./expre_500.png":214,"./task-en.png":756,"./task-zh.png":757};function i(e){var t=s(e);return a(t)}function s(e){var t=n[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}i.keys=function(){return Object.keys(n)},i.resolve=s,e.exports=i,i.id=755},756:
/*!***************************************!*\
  !*** ./src/assets/images/task-en.png ***!
  \***************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){e.exports=a.p+"images/task-en.png"},757:
/*!***************************************!*\
  !*** ./src/assets/images/task-zh.png ***!
  \***************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){e.exports=a.p+"images/task-zh.png"},758:
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskCreate/TaskParamFill.vue?vue&type=style&index=0&id=2ea2dfac&lang=scss&scoped=true& ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){},759:
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/task/TaskCreate/index.vue?vue&type=style&index=0&id=f2f4f9d4&lang=scss&scoped=true& ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,a){},847:
/*!********************************************************************************************!*\
  !*** ./src/pages/task/TaskStep.vue?vue&type=template&id=1a04ac58&scoped=true& + 1 modules ***!
  \********************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["step-wrapper",{"hidden-step-wrapper":e.hiddenBorder}]},[a("div",{staticClass:"step-header"},[a("div",{staticClass:"step-section-title"},[a("span",[e._v(e._s(e.taskTemplateTitle))])])]),e._v(" "),a("div",{staticClass:"division-line"}),e._v(" "),a("div",{staticClass:"step-list"},e._l(e.list,function(t,n){return a("div",{key:n,class:{"step-item":!0,"step-item-first":0===n,finished:e.allFinished||n<e.currentStepIndex,actived:!e.allFinished&&n===e.currentStepIndex},style:e.calChartSize(n)},[a("div",{staticClass:"step-graph"},[n!==e.list.length-1?a("div",{staticClass:"line"}):e._e(),e._v(" "),e.allFinished||n<e.currentStepIndex?a("div",{staticClass:"common-icon-done-thin step-done"}):a("div",{staticClass:"order"},[e._v(e._s(n+1))])]),e._v(" "),a("span",{staticClass:"step-name",style:e.calNameSize(t.name)},[e._v(e._s(t.name))])])}),0)])},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},848:
/*!***********************************************************************************************!*\
  !*** ./src/pages/task/NodePreview.vue?vue&type=template&id=17089648&scoped=true& + 1 modules ***!
  \***********************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"node-preview-wrapper"},[a("div",{staticClass:"operation-header clearfix"},[a("div",{staticClass:"bread-crumbs-wrapper"},e._l(e.previewBread,function(t,n){return a("div",{key:n,class:["path-item",{"name-ellipsis":e.previewBread.length>1}],attrs:{title:e.showBreakList.includes(n)?t.name:""}},[n&&e.showBreakList.includes(n)||1===n?a("span",[e._v("\n                    >\n                ")]):e._e(),e._v(" "),e.showBreakList.includes(n)?a("span",{staticClass:"node-name",attrs:{title:t.name},on:{click:function(a){return e.onSelectSubflow(t.data,n)}}},[e._v("\n                    "+e._s(t.name)+"\n                ")]):1===n?a("span",{staticClass:"node-ellipsis"},[e._v("\n                    "+e._s(e.ellipsis)+"\n                ")]):e._e()])}),0)]),e._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.previewDataLoading,opacity:1},expression:"{ isLoading: previewDataLoading, opacity: 1 }"}],staticClass:"canvas-wrapper"},[e.previewDataLoading?e._e():a("PipelineCanvas",{ref:"pipelineCanvas",attrs:{"is-menu-bar-show":!1,"is-config-bar-show":!1,"is-edit":!1,"is-select-node":e.isSelectNode,"is-select-all-node":e.isSelectAllNode,"is-preview-mode":e.isPreviewMode,"canvas-data":e.canvasData},on:{onNodeClick:e.onNodeClick}})],1)])},i=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return i})},971:
/*!******************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskSelectNode.vue ***!
  \******************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! ./TaskSelectNode.vue?vue&type=template&id=973f0a68&scoped=true& */1053),i=a(/*! ./TaskSelectNode.vue?vue&type=script&lang=js& */748);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(/*! ./TaskSelectNode.vue?vue&type=style&index=0&id=973f0a68&lang=scss&scoped=true& */972);var r=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */1),o=Object(r.a)(i.default,n.a,n.b,!1,null,"973f0a68",null);t.default=o.exports},972:
/*!****************************************************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskSelectNode.vue?vue&type=style&index=0&id=973f0a68&lang=scss&scoped=true& ***!
  \****************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";var n=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./TaskSelectNode.vue?vue&type=style&index=0&id=973f0a68&lang=scss&scoped=true& */752);a.n(n).a},973:
/*!*****************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskParamFill.vue ***!
  \*****************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";a.r(t);var n=a(/*! ./TaskParamFill.vue?vue&type=template&id=2ea2dfac&scoped=true& */1054),i=a(/*! ./TaskParamFill.vue?vue&type=script&lang=js& */753);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(/*! ./TaskParamFill.vue?vue&type=style&index=0&id=2ea2dfac&lang=scss&scoped=true& */974);var r=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */1),o=Object(r.a)(i.default,n.a,n.b,!1,null,"2ea2dfac",null);t.default=o.exports},974:
/*!***************************************************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/TaskParamFill.vue?vue&type=style&index=0&id=2ea2dfac&lang=scss&scoped=true& ***!
  \***************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";var n=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./TaskParamFill.vue?vue&type=style&index=0&id=2ea2dfac&lang=scss&scoped=true& */758);a.n(n).a},975:
/*!*******************************************************************************************************!*\
  !*** ./src/pages/task/TaskCreate/index.vue?vue&type=style&index=0&id=f2f4f9d4&lang=scss&scoped=true& ***!
  \*******************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(e,t,a){"use strict";var n=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./index.vue?vue&type=style&index=0&id=f2f4f9d4&lang=scss&scoped=true& */759);a.n(n).a}}]);
//# sourceMappingURL=14.js.map